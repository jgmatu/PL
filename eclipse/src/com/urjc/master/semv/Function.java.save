package com.urjc.master.semv;

import java.util.ArrayList;
import java.util.List;
import java.util.Map;

import com.urjc.master.semv.APITS.EnumType;
import com.urjc.master.semv.Commands;

public class Function extends Commands {

	private List<Variable> parametros;
	private Ambito ambito;

	public Function(String id, EnumType tipo, Ambito father) {
		super(id, tipo);
		this.ambito = new Ambito(father);
		this.parametros = new ArrayList<>();
	}

	public boolean insertarListParametros(List<String> ids, EnumType tipo) {
		boolean success = true;
		for (String id : ids) {
			success = this.insertarSingleParametro(id, tipo) && success;
		}
		return success;
	}
	
	public boolean insertarSingleParametro(String id, EnumType tipo) {
		Variable v = new Variable(id, tipo);
		boolean success = !parametros.contains(v);
		
		if (success) {
			this.parametros.add(v);			
		}
		return success;
	}
	
	public boolean insertarParametros(Object list) {
		boolean success = true;
		
		if (!(list instanceof LISTPARAM)) {
			System.err.println("No me has pasado una lista de par√°metros");
			return false;
		}
		
		LISTPARAM params = (LISTPARAM) list;
		
		for (Map.Entry<EnumType, List<String>> entry : params.getParametros().entrySet()) {
		    EnumType tipo = entry.getKey();
		    List<String> ids = entry.getValue();
		    success = success && insertarListParametros(ids, tipo);
		}
		return success;
	}
	
	public void setAmbito(Ambito father) {
		this.ambito = father;
	}
	
	public Ambito getAmbito(){
		return this.ambito;
	}
}
